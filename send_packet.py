from scapy.all import TCP, IP, Raw, sendp, Ether, IFACES, UDP, wrpcap

data = "vvvvvhqDvwAxYMeS5DdG9LLsvvvvvvvdCjmESTpscJebBfMcrA1sfdsfdsfsdfWWWZaCVYlTkhM6VS7aoAArAAAJgAALNBpL(dsda"
a = Ether() / IP(src='10.11.1.2', dst='10.11.1.1') / TCP(sport=2568, dport=659) / Raw(load=data)
# iface = IFACES.dev_from_name("veth0")
# a = Ether() / IP(src='192.168.1.68', dst='192.168.1.67') / TCP() / Raw(load=data)
# iface = IFACES.dev_from_name("enp3s0")
# sendp(a, iface=iface)
wrpcap('teste.pcap', a)
# data = 'taiguara'
# a = Ether() / IP(src='10.11.1.2', dst='10.11.1.1') / TCP() / Raw(load=data)
# wrpcap('teste.pcap', a, append=True)

# data = 'pao'
# a = Ether() / IP(src='10.11.1.2', dst='10.11.1.1') / UDP() / Raw(load=data)
# wrpcap('teste.pcap', a, append=True)


"""
SNORT:

CPU:

1 regra:
{'1000': {'user': [309.0, 740.0, 751.0], 'system': [490.0, 836.0, 859.0], 'softirq': [312.89, 792.11, 824.69]}, '2000': {'user': [470.0, 468.0, 701.0], 'system': [730.0, 733.0, 925.0], 'softirq': [615.26, 619.86, 1144.87]}, '4000': {'user': [766.0, 755.0, 746.0], 'system': [970.0, 988.0, 987.0], 'softirq': [904.51, 911.84, 907.33]}, '8000': {'user': [768.0, 759.0, 749.0], 'system': [1169.0, 1182.0, 1176.0], 'softirq': [1126.44, 1126.25, 1115.61]}, '9000': {'user': [733.0, 726.0, 731.0], 'system': [1227.0, 1228.0, 1214.0], 'softirq': [1173.5, 1176.64, 1173.04]}, '10000': {'user': [703.96, 729.0, 717.0], 'system': [1241.58, 1255.0, 1258.0], 'softirq': [1211.34, 1216.42, 1215.27]}} 

200 regras:
{'1000': {'user': [1410.0, 1401.0, 1470.0], 'system': [441.0, 431.0, 435.0], 'softirq': [422.1, 433.4, 426.11]}, '2000': {'user': [1632.0, 1485.0, 1591.0], 'system': [361.0, 513.0, 410.0], 'softirq': [372.3, 514.34, 514.28]}, '4000': {'user': [1580.0, 1583.0, 1581.0], 'system': [420.0, 420.0, 419.0], 'softirq': [422.44, 422.61, 423.79]}, '8000': {'user': [1296.0, 1291.0, 1294.0], 'system': [703.0, 708.0, 710.0], 'softirq': [709.07, 711.55, 711.86]}, '9000': {'user': [1233.0, 1241.0, 1223.0], 'system': [766.0, 762.0, 776.0], 'softirq': [771.18, 764.76, 778.56]}, '10000': {'user': [1180.0, 1185.0, 1178.0], 'system': [827.0, 820.0, 821.0], 'softirq': [827.54, 826.86, 825.19]}}

500 regras:
{'1000': {'user': [1714.0, 1722.0, 1714.0], 'system': [285.0, 281.0, 283.0], 'softirq': [284.36, 280.46, 283.17]}, '2000': {'user': [1629.0, 1542.0, 1623.0], 'system': [306.0, 456.0, 376.0], 'softirq': [316.96, 459.31, 458.95]}, '4000': {'user': [1620.0, 1625.0, 1617.0], 'system': [379.0, 378.0, 383.0], 'softirq': [381.17, 382.29, 387.23]}, '8000': {'user': [1333.0, 1339.0, 1343.0], 'system': [666.0, 660.0, 656.0], 'softirq': [669.6, 666.75, 662.84]}, '9000': {'user': [1274.0, 1273.0, 1268.0], 'system': [734.0, 730.0, 731.0], 'softirq': [735.62, 736.73, 734.82]}, '10000': {'user': [1219.8, 1224.0, 1227.0], 'system': [767.33, 776.0, 776.0], 'softirq': [779.66, 781.94, 787.39]}}

2000 regras:
{'1000': {'user': [1761.0, 1775.0, 1805.0], 'system': [237.0, 223.0, 194.0], 'softirq': [238.32, 235.37, 238.85]}, '2000': {'user': [1790.0, 1569.0, 1571.0], 'system': [209.0, 422.0, 426.0], 'softirq': [211.09, 451.23, 428.77]}, '4000': {'user': [1648.0, 1639.0, 1649.0], 'system': [352.0, 360.0, 351.0], 'softirq': [358.42, 360.73, 357.28]}, '8000': {'user': [1372.0, 1360.0, 1369.0], 'system': [632.0, 640.0, 637.0], 'softirq': [634.41, 642.66, 637.98]}, '9000': {'user': [1291.0, 1308.0, 1301.0], 'system': [709.0, 691.0, 705.0], 'softirq': [710.69, 703.23, 704.85]}, '10000': {'user': [1259.0, 1261.0, 1269.0], 'system': [745.0, 740.0, 737.0], 'softirq': [749.84, 747.84, 753.21]}}

4000 regras:
{'1000': {'user': [1775.0, 1776.0, 1783.0], 'system': [223.0, 222.0, 215.0], 'softirq': [224.72, 223.49, 219.93]}, '2000': {'user': [1801.0, 1274.0, 1597.0], 'system': [198.0, 405.0, 401.0], 'softirq': [200.33, 443.43, 415.43]}, '4000': {'user': [1656.0, 1661.0, 1666.0], 'system': [344.0, 338.0, 340.0], 'softirq': [346.59, 341.05, 342.96]}, '8000': {'user': [1387.0, 1388.0, 1395.0], 'system': [619.0, 619.0, 613.0], 'softirq': [623.04, 620.37, 617.55]}, '9000': {'user': [1320.0, 1319.0, 1316.0], 'system': [679.0, 679.0, 683.0], 'softirq': [680.79, 683.91, 684.21]}, '10000': {'user': [1273.0, 1274.0, 1273.0], 'system': [726.0, 731.0, 729.0], 'softirq': [735.03, 734.1, 739.22]}}

6000 regras:
{'1000': {'user': [1802.0, 1784.0, 1781.0], 'system': [197.0, 215.0, 222.0], 'softirq': [220.17, 222.04, 226.68]}, '2000': {'user': [1806.0, 1651.0, 1593.0], 'system': [193.0, 348.0, 406.0], 'softirq': [198.08, 443.26, 405.69]}, '4000': {'user': [1661.0, 1656.0, 1660.0], 'system': [338.0, 342.0, 339.0], 'softirq': [343.82, 346.61, 342.92]}, '8000': {'user': [1388.0, 1392.0, 1377.0], 'system': [610.0, 612.0, 622.0], 'softirq': [613.08, 616.04, 627.94]}, '9000': {'user': [1317.0, 1324.0, 1326.0], 'system': [683.0, 675.0, 673.0], 'softirq': [684.57, 678.07, 679.12]}, '10000': {'user': [1279.0, 1273.0, 1270.0], 'system': [727.0, 732.0, 729.0], 'softirq': [730.75, 732.23, 730.32]}}

------------------------------------------------------------------

SURICATA:

CPU

1 regra:
{'1000': {'user': [154.0, 190.0, 194.0], 'system': [92.0, 94.0, 96.0], 'softirq': [145.15, 145.18, 151.65]}, '2000': {'user': [313.0, 314.0, 317.0], 'system': [218.0, 218.0, 213.0], 'softirq': [340.45, 338.6, 337.42]}, '4000': {'user': [331.0, 257.0, 278.0], 'system': [211.0, 207.0, 217.0], 'softirq': [327.5, 331.38, 304.62]}, '8000': {'user': [341.0, 445.0, 435.0], 'system': [303.0, 300.0, 302.0], 'softirq': [435.69, 439.01, 442.93]}, '9000': {'user': [499.0, 484.0, 494.0], 'system': [347.0, 355.0, 348.0], 'softirq': [486.72, 493.05, 486.99]}, '10000': {'user': [529.0, 527.0, 526.0], 'system': [392.0, 400.0, 396.0], 'softirq': [525.94, 527.89, 539.91]}}

200 regras:
{'1000': {'user': [205.0, 210.0, 208.0], 'system': [92.0, 92.0, 87.0], 'softirq': [143.49, 138.87, 138.05]}, '2000': {'user': [343.0, 318.0, 246.0], 'system': [178.0, 153.0, 132.0], 'softirq': [274.15, 248.43, 194.93]}, '4000': {'user': [278.0, 358.0, 306.0], 'system': [200.0, 188.0, 205.0], 'softirq': [306.05, 291.24, 304.33]}, '8000': {'user': [503.0, 377.0, 399.0], 'system': [307.0, 307.0, 309.0], 'softirq': [439.22, 434.72, 441.81]}, '9000': {'user': [565.0, 562.0, 566.0], 'system': [356.0, 361.0, 357.0], 'softirq': [489.28, 484.76, 485.3]}, '10000': {'user': [610.0, 609.0, 603.0], 'system': [399.0, 397.0, 401.0], 'softirq': [518.75, 515.93, 526.78]}}

500 regras:
{'1000': {'user': [339.0, 316.0, 310.0], 'system': [113.0, 103.0, 94.0], 'softirq': [162.2, 153.16, 140.97]}, '2000': {'user': [309.0, 434.0, 429.0], 'system': [128.0, 177.0, 177.0], 'softirq': [205.85, 256.85, 259.75]}, '4000': {'user': [381.0, 365.0, 376.0], 'system': [196.0, 180.0, 190.0], 'softirq': [261.35, 260.97, 259.99]}, '8000': {'user': [709.0, 708.0, 705.0], 'system': [328.0, 328.0, 331.0], 'softirq': [430.26, 432.6, 431.58]}, '9000': {'user': [772.0, 783.0, 790.0], 'system': [376.0, 381.0, 382.0], 'softirq': [473.28, 478.03, 480.32]}, '10000': {'user': [840.0, 836.0, 839.0], 'system': [418.0, 427.0, 428.0], 'softirq': [503.85, 506.58, 510.11]}}

2000 regras:
{'1000': {'user': [520.0, 495.0, 403.0], 'system': [147.0, 154.0, 125.0], 'softirq': [207.09, 212.22, 177.14]}, '2000': {'user': [477.0, 452.0, 445.0], 'system': [144.0, 139.0, 128.0], 'softirq': [209.15, 198.76, 194.69]}, '4000': {'user': [411.0, 426.0, 411.0], 'system': [159.0, 166.0, 161.0], 'softirq': [229.67, 232.09, 232.43]}, '8000': {'user': [888.0, 883.0, 896.0], 'system': [352.0, 355.0, 346.0], 'softirq': [432.29, 428.65, 427.64]}, '9000': {'user': [986.0, 985.0, 975.0], 'system': [409.0, 399.0, 411.0], 'softirq': [469.58, 456.73, 476.81]}, '10000': {'user': [1050.0, 1056.0, 1041.0], 'system': [445.0, 447.0, 440.0], 'softirq': [496.44, 502.51, 499.43]}}

4000 regras:
{'1000': {'user': [524.0, 533.0, 503.0], 'system': [144.0, 141.0, 127.0], 'softirq': [190.79, 191.53, 175.68]}, '2000': {'user': [398.0, 450.0, 424.0], 'system': [112.0, 112.0, 129.0], 'softirq': [158.02, 165.07, 173.55]}, '4000': {'user': [462.0, 462.0, 487.0], 'system': [168.0, 170.0, 169.0], 'softirq': [219.41, 223.89, 223.41]}, '8000': {'user': [1031.0, 1015.0, 1032.0], 'system': [370.0, 375.0, 366.0], 'softirq': [419.34, 426.54, 424.57]}, '9000': {'user': [1124.0, 1119.0, 1124.0], 'system': [436.0, 427.0, 427.0], 'softirq': [469.48, 470.02, 460.37]}, '10000': {'user': [1171.0, 1178.0, 1171.0], 'system': [474.0, 482.0, 481.0], 'softirq': [498.17, 499.55, 501.33]}}

6000 regras:
{'1000': {'user': [425.0, 464.0, 523.0], 'system': [95.0, 116.0, 123.0], 'softirq': [137.63, 154.01, 170.16]}, '2000': {'user': [464.0, 488.0, 549.0], 'system': [135.0, 141.0, 137.0], 'softirq': [177.78, 201.87, 199.73]}, '4000': {'user': [490.0, 466.0, 500.0], 'system': [168.0, 166.0, 158.0], 'softirq': [224.33, 220.85, 221.58]}, '8000': {'user': [1096.0, 1099.0, 1101.0], 'system': [389.0, 378.0, 371.0], 'softirq': [424.82, 420.98, 422.46]}, '9000': {'user': [1188.0, 1196.0, 1187.0], 'system': [443.0, 445.0, 442.0], 'softirq': [470.8, 478.12, 468.73]}, '10000': {'user': [1238.0, 1249.0, 1255.0], 'system': [491.0, 482.0, 475.0], 'softirq': [504.32, 495.74, 487.67]}}

"""